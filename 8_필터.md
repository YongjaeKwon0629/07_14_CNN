# 🎯 CNN의 기초 필터: 수직, 수평, 대각선 필터 완전 정복

## 📌 이 문서에서는

- CNN에서 필터(Filter)가 무슨 일을 하는지
- 수직/수평/대각선 필터의 실제 구조와 작동 방식
- 필터 적용 결과가 어떻게 Feature Map으로 나타나는지
- CNN에서 필터를 어떻게 "학습"하는지

를 초보자도 이해할 수 있도록 설명합니다.

---

## 🧠 필터란?

CNN에서 **필터(Filter)** 또는 **커널(Kernel)** 은 이미지를 훑으면서 **특정한 시각적 패턴(특징)을 감지하는 작은 행렬**입니다.  
대표적으로 경계선(edge), 윤곽선, 색 변화 등 시각적으로 중요한 정보를 추출할 수 있습니다.

CNN의 첫 번째 합성곱 계층(Convolution Layer)에서는 일반적으로  
**가장 기초적인 시각 패턴을 감지하는 필터들**이 사용됩니다:

- 수직선 감지 필터
- 수평선 감지 필터
- 대각선 감지 필터

---

## 📐 필터의 기본 구조 (3x3 예시)

CNN에서 흔히 쓰이는 기본 필터 크기는 3x3입니다.

### 🔹 수평 필터 (Horizontal Edge Detector)

```
[-1, -1, -1]
[ 0,  0,  0]
[ 1,  1,  1]
```

-  위쪽과 아래쪽 픽셀 간의 변화가 클 때 강하게 반응

-  즉, 수평 경계선을 강조
  
## 🔹 수직 필터 (Vertical Edge Detector)
text
코드 복사
[-1,  0,  1]
[-1,  0,  1]
[-1,  0,  1]
왼쪽과 오른쪽 픽셀 간의 변화에 민감

즉, 수직 방향의 경계선을 강조

## 🔹 대각선 필터 (Diagonal Edge Detector)  

-  ↘ 방향 대각선 (양의 기울기)
    
```
[ 0,  0,  1]
[ 0,  1,  0]
[ 1,  0,  0]
```
-  ↙ 방향 대각선 (음의 기울기)
  
```
[ 1,  0,  0]
[ 0,  1,  0]
[ 0,  0,  1]
```

-  물체의 대각선 윤곽을 잡아내는 데 유용

## 🔍 필터 적용 예시 (Convolution)
### 🎨 입력 이미지 예 (5x5 단순 이미지)
```
0  0  0  0  0  
0  0  1  0  0  
0  0  1  0  0  
0  0  1  0  0  
0  0  0  0  0
```
위 이미지는 세로로 길게 있는 숫자 '1'의 모양이라고 가정

## 📏 수직 필터 적용 결과

-  출력 값이 가운데 수직 줄에서 강하게 나옴  
-  수직선을 감지 → 값이 높아짐  
-  CNN은 이런 출력(Feature Map)을 통해 **이 부분은 수직 경계가 있다**는 것을 인식합니다.

## 🧪 시각적으로 비교해보기
| 필터 종류  | 감지 방향       | 사용 목적              |
| ------ | ----------- | ------------------ |
| 수직 필터  | 왼쪽 ↔ 오른쪽 차이 | 물체의 세로 윤곽선 감지      |
| 수평 필터  | 위 ↔ 아래 차이   | 물체의 가로 윤곽선 감지      |
| 대각선 필터 | ↘, ↙ 방향 차이  | 물체의 기울기나 대각선 구조 감지 |


## 🤖 CNN에서는 이 필터를 어떻게 사용할까?
초기 CNN 구조에서는 위에서 설명한 필터를 사람이 직접 정의했습니다. (예: Sobel Filter)
하지만 현대 CNN에서는 필터를 직접 학습합니다.

CNN은 처음에는 필터 값이 랜덤하게 설정됨

학습 과정 중 역전파(Backpropagation) 를 통해 필터 값이 조금씩 조정됨

결과적으로 수직선에 반응하는 필터, 곡선에 반응하는 필터 등이 자동으로 형성됨

즉, 수직/수평/대각선 필터는 CNN의 시각적 기초 감각을 형성하는 중요한 요소입니다.

## 💻 실습 코드 예 (OpenCV로 필터 적용)
```
import cv2
import numpy as np
import matplotlib.pyplot as plt

# 이미지 불러오기 (흑백)
img = cv2.imread('your_image.png', 0)

# 수평 필터 정의
horizontal_filter = np.array([[-1, -1, -1],
                              [ 0,  0,  0],
                              [ 1,  1,  1]])

# 필터 적용
filtered = cv2.filter2D(img, -1, horizontal_filter)

# 결과 출력
plt.imshow(filtered, cmap='gray')
plt.title('Horizontal Edges')
plt.axis('off')
plt.show()
```
## 🧠 마무리 요약
-  CNN에서 필터는 특징을 감지하는 눈과 같다.

-  수직/수평/대각선 필터는 에지를 감지하는 기본 단위이다.

-  현대 CNN은 이 필터들을 스스로 학습해내며, 복잡한 패턴도 자동으로 감지한다.

-  CNN이 깊어질수록 필터는 단순한 경계 → 복잡한 형태 → 전체 개체 인식으로 발전한다.

💡 추천 실습: 필터 시각화 도구나 OpenCV를 활용해 직접 이미지에 필터를 적용해보세요. CNN이 "무엇을 보고 있는지" 감이 잡힙니다!
