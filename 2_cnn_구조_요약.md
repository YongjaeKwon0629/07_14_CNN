## 2. CNN 구조 요약

### 🧭 CNN은 어떤 흐름으로 동작하나요?

CNN은 여러 계층(Layer)들을 쌓아서 구성되며, 각 계층은 이미지에서 점점 더 복잡한 정보를 추출합니다.  
전체 구조는 **간단한 선형 흐름**처럼 보이지만, 내부에서는 굉장히 많은 연산과 학습이 일어납니다.

---

### 📊 전체 구조 요약

[입력 이미지]  
↓  
[Convolution Layer] → [ReLU]  
↓  
[Pooling Layer]  
↓  
[Convolution Layer] → [ReLU]  
↓  
[Pooling Layer]  
↓  
[Flatten]  
↓  
[Fully Connected Layer (Dense)]  
↓  
[Softmax (분류 결과)]  

이 흐름을 통해 CNN은 **단순한 모양 → 윤곽선 → 복잡한 형태 → 최종 분류**로 점점 더 고차원적인 특징(feature)을 추출하게 됩니다.

---

### 🧱 각 구성 요소의 역할

#### 🔹 1. 입력 이미지 (Input Image)
- 크기 예시: `28 x 28` 또는 `224 x 224` 등
- 흑백이면 채널 1개, 컬러(RGB)이면 채널 3개

#### 🔹 2. Convolution Layer (합성곱 층)
- **이미지의 작은 영역(패치)**을 필터로 스캔하면서 특징을 추출
- 예: 테두리, 수평선, 곡선 등 시각적 패턴 감지
- 여러 개의 필터를 통해 다양한 특징을 동시에 학습

#### 🔹 3. Activation Function (ReLU)
- 음수는 0, 양수는 그대로 출력하는 함수
- 이미지에 비선형성 부여 → 복잡한 패턴도 인식 가능

#### 🔹 4. Pooling Layer (예: Max Pooling)
- 공간 정보를 요약하여 **연산량을 줄이고 과적합을 방지**
- 대표적으로 Max Pooling은 가장 큰 값을 골라냄

#### 🔹 5. Flatten
- 2D 이미지 특징 맵을 1D 벡터로 변환
- Fully Connected Layer에 연결되기 위한 준비 단계

#### 🔹 6. Fully Connected Layer (Dense Layer)
- Flatten된 특징을 바탕으로 최종 판단
- 이미지 전체 정보를 기반으로 분류 결정

#### 🔹 7. Output Layer (Softmax 등)
- 결과를 확률값으로 변환 → 어떤 클래스에 속하는지 예측
- 예: [고양이 90%, 강아지 10%]

---

### 🎯 실제 예시: 손글씨 숫자 분류 (MNIST)

| 단계 | 데이터 형태 | 설명 |
|------|-------------|------|
| Input | (28, 28, 1) | 흑백 숫자 이미지 |
| Conv + ReLU | (28, 28, 32) | 32개의 특징 추출 |
| Pooling | (14, 14, 32) | 크기 절반으로 감소 |
| Conv + ReLU | (14, 14, 64) | 더 많은 특징 추출 |
| Pooling | (7, 7, 64) | 또다시 절반 |
| Flatten | (3136,) | 1차원 벡터로 변환 |
| Dense | (128,) | 중간 판단층 |
| Output (Softmax) | (10,) | 숫자 0~9 중 예측 결과 |

---

### 🧠 CNN은 계층별로 무엇을 학습할까?

| 계층 | 학습 내용 예시 |
|------|----------------|
| 초기 Convolution | 엣지(Edge), 선(Line) 등 단순한 패턴 |
| 중간 Convolution | 눈, 귀, 물체 일부 등 조합된 특징 |
| 후반 Dense Layer | 전체 구조나 의미 (예: 고양이 얼굴) |

---

### 🔑 핵심 요약

| 구성 요소 | 기능 요약 |
|------------|------------|
| **Convolution** | 이미지에서 지역적인 특징 추출 |
| **ReLU** | 비선형성 부여 (활성화 함수) |
| **Pooling** | 중요 정보만 남기고 압축 |
| **Flatten** | 고차원 데이터를 1D로 펼치기 |
| **Fully Connected** | 특징을 종합해 최종 판단 |
| **Output (Softmax)** | 클래스별 확률 출력 |

---

> 📌 **Tip**: CNN은 마치 여러 개의 '필터링 안경'을 차례차례 끼고 이미지를 보는 것과 같아요.  
> 처음엔 테두리만 보이지만, 점점 더 정교한 구조를 인식하게 됩니다.
